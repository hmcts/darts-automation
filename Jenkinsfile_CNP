#!groovy
//noinspection GroovyUnusedAssignment
@Library("Infrastructure") 

import uk.gov.hmcts.contino.GradleBuilder

def type = "java"
def product = "darts"
def component = "automation"

withPipeline(type, product, component) {
  disableLegacyDeployment()
  nonServiceApp()
  enableSlackNotifications('#darts-builds')

  afterAlways('test') {
    builder.gradle('jacocoTestReport')

    // publishHTML target: [
    //   allowMissing         : true,
    //   alwaysLinkToLastBuild: true,
    //   keepAll              : true,
    //   reportDir            : "build/reports/checkstyle",
    //   reportFiles          : "main.html",
    //   reportName           : "Checkstyle Main Report"
    // ]

    // publishHTML target: [
    //   allowMissing         : true,
    //   alwaysLinkToLastBuild: true,
    //   keepAll              : true,
    //   reportDir            : "build/reports/checkstyle",
    //   reportFiles          : "test.html",
    //   reportName           : "Checkstyle Test Report"
    // ]

    publishHTML target: [
      allowMissing         : true,
      alwaysLinkToLastBuild: true,
      keepAll              : true,
      reportDir            : "build/reports/tests/test",
      reportFiles          : "index.html",
      reportName           : "Unit Tests Report"
    ]
  }

}
